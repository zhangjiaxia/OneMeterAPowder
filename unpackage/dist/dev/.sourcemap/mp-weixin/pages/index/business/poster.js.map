{"version":3,"sources":["webpack:///D:/project/uniRiceNoodle/main.js","webpack:///D:/project/uniRiceNoodle/pages/index/business/poster.vue?af46","webpack:///D:/project/uniRiceNoodle/pages/index/business/poster.vue?e889","webpack:///D:/project/uniRiceNoodle/pages/index/business/poster.vue?bb93","webpack:///D:/project/uniRiceNoodle/pages/index/business/poster.vue?681e","webpack:///D:/project/uniRiceNoodle/pages/index/business/poster.vue","webpack:///D:/project/uniRiceNoodle/pages/index/business/poster.vue?d1fc","webpack:///D:/project/uniRiceNoodle/pages/index/business/poster.vue?9bec"],"names":["createPage","Page","components","navigationBar","data","navigationBarStyle","iconText","shareInfo","bgImg","qrcode","width","height","systemInfo","poster","onLoad","options","uni","showLoading","title","mask","duration","getQrcode","methods","that","interfaceurl","checkAuth","getAppletCode","then","res","saveQrCode","url","wx","downloadFile","success","statusCode","tempFilePath","console","log","drawBefore","getSystemInfo","pixelRatio","statusBarHeight","windowWidth","query","createSelectorQuery","select","boundingClientRect","drawImage","exec","saveImg","e","saveImageToPhotosAlbum","filePath","hideLoading","showModal","content","showCancel","fail","err","errMsg","modalSuccess","openSetting","settingdata","authSetting","failData","complete","finishData","previewImg","previewImage","urls","canvasAttrs","ctx","createCanvasContext","canvasW","canvasH","headerW","headerX","headerY","qrcodeW","qrcodeX","qrcodeY","save","draw","setTimeout","canvasToTempFilePath","x","y","destWidth","destHeight","canvasId"],"mappings":";;;;;;;;;;kDAAA,wCAAmB;;AAEnB;AACA,wG;AACAA,UAAU,CAACC,eAAD,CAAV,C;;;;;;;;;;;;;ACJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmH;AACnH;AAC0D;AACL;AACc;;;AAGnE;AAC0M;AAC1M,gBAAgB,oNAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,iFAAM;AACR,EAAE,0FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAsyB,CAAgB,mzBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;ACa1zB;AACA,+G,8FAdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;2TAI4D;eAC7C,EACdC,UAAU,EAAE,EACXC,aAAa,EAAbA,aADW,EADE,EAIdC,IAJc,kBAIP,CACN,OAAO,EACN;AACAC,wBAAkB,EAAE,EACnBC,QAAQ,EAAE,MADS,CACF;AADE,OAFd,EAKNC,SAAS,EAAE,EACVC,KAAK,EAAE,gBADG,EAEVC,MAAM,EAAE,EAFE,EALL;AASN;AACAC,WAAK,EAAE,CAVD;AAWNC,YAAM,EAAE,CAXF;AAYNC,gBAAU,EAAE,EAZN;AAaNC,YAAM,EAAE,EAbF,CAaK;AAbL,KAAP;AAeA,GApBa;AAqBdC,QArBc,kBAqBPC,OArBO,EAqBE;AACfC,OAAG,CAACC,WAAJ,CAAgB;AACfC,WAAK,EAAE,UADQ;AAEfC,UAAI,EAAE,IAFS;AAGfC,cAAQ,EAAE,IAHK,EAAhB;;AAKA,SAAKC,SAAL;AACA,GA5Ba;AA6BdC,SAAO,EAAE;AACR;AACAD,aAFQ,uBAEI;AACX,UAAIE,IAAI,GAAG,IAAX;AACAC,yBAAaC,SAAb,CAAuBD,mBAAaE,aAApC,EAAmD,EAAnD,EAAuDC,IAAvD,CAA4D,UAACC,GAAD,EAAS;AACpEL,YAAI,CAACM,UAAL,CAAgBD,GAAG,CAACxB,IAAJ,CAAS0B,GAAzB;AACA,OAFD;AAGA,KAPO;AAQR;AACAD,cATQ,sBASGC,GATH,EASQ;AACf,UAAIP,IAAI,GAAG,IAAX;AACAQ,QAAE,CAACC,YAAH,CAAgB;AACfF,WAAG,EAAEA,GADU,EACL;AACVG,eAAO,EAAE,iBAASL,GAAT,EAAc;AACtB;AACA,cAAIA,GAAG,CAACM,UAAJ,KAAmB,GAAvB,EAA4B;AAC3B;AACAX,gBAAI,CAAChB,SAAL,CAAeE,MAAf,GAAwBmB,GAAG,CAACO,YAA5B;AACAC,mBAAO,CAACC,GAAR,CAAY,iBAAZ,EAA8Bd,IAAI,CAAChB,SAAnC;AACAgB,gBAAI,CAACe,UAAL;AACA;AACD,SAVc,EAAhB;;AAYA,KAvBO;AAwBRA,cAxBQ,wBAwBK;AACZ,UAAIf,IAAI,GAAG,IAAX;AACA;AACAQ,QAAE,CAACQ,aAAH,CAAiB;AAChBN,eADgB,mBACRL,GADQ,EACH;AACZL,cAAI,CAACX,UAAL,GAAkBgB,GAAlB;AACA;AACAL,cAAI,CAACb,KAAL,GAAa,MAAMkB,GAAG,CAACY,UAAvB;AACAjB,cAAI,CAACZ,MAAL,GAAc,MAAMiB,GAAG,CAACY,UAAV,GAAuBZ,GAAG,CAACa,eAAJ,GAAsBb,GAAG,CAACY,UAAjD,GAA8D,KAAKZ,GAAG,CAACY,UAArF;AACAjB,cAAI,CAACb,KAAL,GAAakB,GAAG,CAACc,WAAJ,GAAkBd,GAAG,CAACY,UAAnC;AACA;AACA,cAAIG,KAAK,GAAGZ,EAAE,CAACa,mBAAH,EAAZ;AACAD,eAAK,CAACE,MAAN,CAAa,eAAb,EAA8BC,kBAA9B,CAAiD,UAAClB,GAAD,EAAS;AACzD;AACAL,gBAAI,CAACwB,SAAL,CAAenB,GAAf;AACA,WAHD,EAGGoB,IAHH;AAIA,SAbe,EAAjB;;AAeA,KA1CO;AA2CR;AACAC,WA5CQ,mBA4CAC,CA5CA,EA4CG;AACV,UAAI3B,IAAI,GAAG,IAAX;AACAP,SAAG,CAACC,WAAJ,CAAgB;AACfC,aAAK,EAAE,QADQ,EAAhB;;AAGAa,QAAE,CAACC,YAAH,CAAgB;AACfF,WAAG,EAAEP,IAAI,CAACV,MADK;AAEfoB,eAAO,EAAE,iBAASL,GAAT,EAAc;AACtB;AACAG,YAAE,CAACoB,sBAAH,CAA0B;AACzBC,oBAAQ,EAAExB,GAAG,CAACO,YADW;AAEzBF,mBAAO,EAAE,iBAAS7B,IAAT,EAAe;AACvB2B,gBAAE,CAACsB,WAAH;AACAtB,gBAAE,CAACuB,SAAH,CAAa;AACZpC,qBAAK,EAAE,IADK;AAEZqC,uBAAO,EAAE,wBAFG;AAGZC,0BAAU,EAAE,KAHA,EAAb;;AAKA,aATwB;AAUzBC,gBAAI,EAAE,cAASC,GAAT,EAAc;AACnB,kBAAIA,GAAG,CAACC,MAAJ,KAAe,yCAAf,IAA4DD,GAAG,CAACC,MAAJ;AAC/D,qDADD,EAC0C;AACzC;AACA5B,kBAAE,CAACuB,SAAH,CAAa;AACZpC,uBAAK,EAAE,IADK;AAEZqC,yBAAO,EAAE,WAFG;AAGZC,4BAAU,EAAE,KAHA;AAIZvB,yBAAO,EAAE,iBAAA2B,YAAY,EAAI;AACxB7B,sBAAE,CAAC8B,WAAH,CAAe;AACd5B,6BADc,mBACN6B,WADM,EACO;AACpB1B,+BAAO,CAACC,GAAR,CAAY,aAAZ,EAA2ByB,WAA3B;AACA,4BAAIA,WAAW,CAACC,WAAZ,CAAwB,wBAAxB,CAAJ,EAAuD;AACtDhC,4BAAE,CAACuB,SAAH,CAAa;AACZpC,iCAAK,EAAE,IADK;AAEZqC,mCAAO,EAAE,mBAFG;AAGZC,sCAAU,EAAE,KAHA,EAAb;;AAKA,yBAND,MAMO;AACNzB,4BAAE,CAACuB,SAAH,CAAa;AACZpC,iCAAK,EAAE,IADK;AAEZqC,mCAAO,EAAE,mBAFG;AAGZC,sCAAU,EAAE,KAHA,EAAb;;AAKA;AACD,uBAhBa;AAiBdC,0BAjBc,gBAiBTO,QAjBS,EAiBC;AACd5B,+BAAO,CAACC,GAAR,CAAY,UAAZ,EAAwB2B,QAAxB;AACA,uBAnBa;AAoBdC,8BApBc,oBAoBLC,UApBK,EAoBO;AACpB9B,+BAAO,CAACC,GAAR,CAAY,YAAZ,EAA0B6B,UAA1B;AACA,uBAtBa,EAAf;;AAwBA,mBA7BW,EAAb;;AA+BA;AACD,aA9CwB;AA+CzBD,oBA/CyB,oBA+ChBrC,GA/CgB,EA+CX;AACbZ,iBAAG,CAACqC,WAAJ;AACA,aAjDwB,EAA1B;;AAmDA,SAvDc,EAAhB;;AAyDA,KA1GO;AA2GR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAc,cAtIQ,wBAsIK;AACZ/B,aAAO,CAACC,GAAR,CAAY,YAAZ;AACA,UAAI,KAAKxB,MAAT,EAAiB;AAChB;AACAkB,UAAE,CAACqC,YAAH,CAAgB;AACfC,cAAI,EAAE,CAAC,KAAKxD,MAAN,CADS,EAAhB;;AAGA;AACD,KA9IO;AA+IRkC,aA/IQ,qBA+IEuB,WA/IF,EA+Ie;AACtB,UAAI/C,IAAI,GAAG,IAAX;AACA,UAAIgD,GAAG,GAAGxC,EAAE,CAACyC,mBAAH,CAAuB,cAAvB,EAAuC,IAAvC,CAAV;AACA,UAAIC,OAAO,GAAGlD,IAAI,CAACb,KAAnB,CAHsB,CAGG;AACzB,UAAIgE,OAAO,GAAGnD,IAAI,CAACZ,MAAnB,CAJsB,CAII;AAC1B;AACA,UAAIgE,OAAO,GAAG,KAAK,KAAK/D,UAAL,CAAgB4B,UAAnC;AACA,UAAIoC,OAAO,GAAG,CAACH,OAAO,GAAGE,OAAX,IAAsB,CAApC;AACA,UAAIE,OAAO,GAAG,KAAK,KAAKjE,UAAL,CAAgB4B,UAAnC;AACA,UAAIsC,OAAO,GAAG,KAAK,KAAKlE,UAAL,CAAgB4B,UAAnC;AACA,UAAIuC,OAAO,GAAG,MAAM,KAAKnE,UAAL,CAAgB4B,UAApC;AACA,UAAIwC,OAAO,GAAG,MAAM,KAAKpE,UAAL,CAAgB4B,UAApC;AACA;AACA+B,SAAG,CAACxB,SAAJ,CAAc,KAAKxC,SAAL,CAAeC,KAA7B,EAAoC,CAApC,EAAuC,CAAvC,EAA0CiE,OAA1C,EAAmDC,OAAnD;AACAH,SAAG,CAACU,IAAJ;AACA;AACA;AACAV,SAAG,CAACxB,SAAJ,CAAc,KAAKxC,SAAL,CAAeE,MAA7B,EAAqC,CAArC,EAAwC,CAAxC,EAA2CqE,OAA3C,EAAoDA,OAApD;AACAP,SAAG,CAACU,IAAJ;AACA;AACAV,SAAG,CAACW,IAAJ;AACAC,gBAAU,CAAC,YAAM;AAChB;AACApD,UAAE,CAACqD,oBAAH,CAAwB;AACvBC,WAAC,EAAE,EADoB;AAEvBC,WAAC,EAAE,EAFoB;AAGvB5E,eAAK,EAAE+D,OAAO,GAAG,EAHM;AAIvB9D,gBAAM,EAAE+D,OAAO,GAAG,EAJK;AAKvBa,mBAAS,EAAEd,OAAO,GAAG,EALE;AAMvBe,oBAAU,EAAEd,OAAO,GAAG,EANC;AAOvBe,kBAAQ,EAAE,cAPa;AAQvBxD,iBAAO,EAAE,iBAACL,GAAD,EAAS;AACjBL,gBAAI,CAACV,MAAL,GAAce,GAAG,CAACO,YAAlB;AACAC,mBAAO,CAACC,GAAR,CAAY,aAAZ,EAA2Bd,IAAI,CAACV,MAAhC;AACAG,eAAG,CAACqC,WAAJ;AACA,WAZsB,EAAxB;;AAcA,OAhBS,EAgBP,GAhBO,CAAV;AAiBA,KArLO,EA7BK,E;;;;;;;;;;;;;AChBf;AAAA;AAAA;AAAA;AAAu8C,CAAgB,y5CAAG,EAAC,C;;;;;;;;;;;ACA39C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/index/business/poster.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\n\nimport Vue from 'vue'\nimport Page from './pages/index/business/poster.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./poster.vue?vue&type=template&id=63eaf01f&\"\nvar renderjs\nimport script from \"./poster.vue?vue&type=script&lang=js&\"\nexport * from \"./poster.vue?vue&type=script&lang=js&\"\nimport style0 from \"./poster.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"uniRiceNoodle/pages/index/business/poster.vue\"\nexport default component.exports","export * from \"-!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./poster.vue?vue&type=template&id=63eaf01f&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./poster.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./poster.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport interfaceurl from '@/utils/interface.js'\nimport imgformat from '@/utils/base64-arraybuffer.js' //图片数据格式转换\nimport navigationBar from '@/components/navigation-bar.vue' //引入自定义导航栏\nexport default {\n\tcomponents: {\n\t\tnavigationBar\n\t},\n\tdata() {\n\t\treturn {\n\t\t\t//设置导航栏样式\n\t\t\tnavigationBarStyle: {\n\t\t\t\ticonText: '分享海报' //导航栏文字\n\t\t\t},\n\t\t\tshareInfo: {\n\t\t\t\tbgImg: '/static/bg.png',\n\t\t\t\tqrcode: ''\n\t\t\t},\n\t\t\t//画布的宽高\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\tsystemInfo: {},\n\t\t\tposter: '' //生成的海报\n\t\t}\n\t},\n\tonLoad(options) {\n\t\tuni.showLoading({\n\t\t\ttitle: '海报生成中...',\n\t\t\tmask: true,\n\t\t\tduration: 3000\n\t\t});\n\t\tthis.getQrcode();\n\t},\n\tmethods: {\n\t\t//获取动态二维码（可携带参数）\n\t\tgetQrcode() {\n\t\t\tlet that = this;\n\t\t\tinterfaceurl.checkAuth(interfaceurl.getAppletCode, {}).then((res) => {\n\t\t\t\tthat.saveQrCode(res.data.url)\n\t\t\t});\n\t\t},\n\t\t// 保存接口传回来的小程序二维码链接\n\t\tsaveQrCode(url) {\n\t\t\tlet that = this;\n\t\t\twx.downloadFile({\n\t\t\t\turl: url, //网络链接\n\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t// 只要服务器有响应数据，就会把响应内容写入文件并进入 success 回调，业务需要自行判断是否下载到了想要的内容\n\t\t\t\t\tif (res.statusCode === 200) {\n\t\t\t\t\t\t//将下载的图片临时路径赋值给img_l,用于预览图片\n\t\t\t\t\t\tthat.shareInfo.qrcode = res.tempFilePath;\n\t\t\t\t\t\tconsole.log('that.drawBefore',that.shareInfo)\n\t\t\t\t\t\tthat.drawBefore();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tdrawBefore() {\n\t\t\tlet that = this;\n\t\t\t//画布的宽高赋值渲染是最大的坑点\n\t\t\twx.getSystemInfo({\n\t\t\t\tsuccess(res) {\n\t\t\t\t\tthat.systemInfo = res;\n\t\t\t\t\t// 通过像素比计算出画布的实际大小（330x490）是展示的出来的大小\n\t\t\t\t\tthat.width = 330 * res.pixelRatio\n\t\t\t\t\tthat.height = 490 * res.pixelRatio - res.statusBarHeight * res.pixelRatio - 44 * res.pixelRatio\n\t\t\t\t\tthat.width = res.windowWidth * res.pixelRatio\n\t\t\t\t\t// that.height = res.screenHeight * res.pixelRatio - res.statusBarHeight * res.pixelRatio - 44 * res.pixelRatio\n\t\t\t\t\tvar query = wx.createSelectorQuery()\n\t\t\t\t\tquery.select('#canvasPoster').boundingClientRect((res) => {\n\t\t\t\t\t\t// 返回值包括画布的实际宽高\n\t\t\t\t\t\tthat.drawImage(res);\n\t\t\t\t\t}).exec();\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t// 保存海报\n\t\tsaveImg(e) {\n\t\t\tlet that = this\n\t\t\tuni.showLoading({\n\t\t\t\ttitle: '保存中...'\n\t\t\t})\n\t\t\twx.downloadFile({\n\t\t\t\turl: that.poster,\n\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t//图片保存到本地\n\t\t\t\t\twx.saveImageToPhotosAlbum({\n\t\t\t\t\t\tfilePath: res.tempFilePath,\n\t\t\t\t\t\tsuccess: function(data) {\n\t\t\t\t\t\t\twx.hideLoading()\n\t\t\t\t\t\t\twx.showModal({\n\t\t\t\t\t\t\t\ttitle: '提示',\n\t\t\t\t\t\t\t\tcontent: '您的推广海报已存入手机相册，赶快分享给好友吧',\n\t\t\t\t\t\t\t\tshowCancel: false,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail: function(err) {\n\t\t\t\t\t\t\tif (err.errMsg === \"saveImageToPhotosAlbum:fail:auth denied\" || err.errMsg ===\n\t\t\t\t\t\t\t\t\"saveImageToPhotosAlbum:fail auth deny\") {\n\t\t\t\t\t\t\t\t// 这边微信做过调整，必须要在按钮中触发，因此需要在弹框回调中进行调用\n\t\t\t\t\t\t\t\twx.showModal({\n\t\t\t\t\t\t\t\t\ttitle: '提示',\n\t\t\t\t\t\t\t\t\tcontent: '需要您授权保存相册',\n\t\t\t\t\t\t\t\t\tshowCancel: false,\n\t\t\t\t\t\t\t\t\tsuccess: modalSuccess => {\n\t\t\t\t\t\t\t\t\t\twx.openSetting({\n\t\t\t\t\t\t\t\t\t\t\tsuccess(settingdata) {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"settingdata\", settingdata)\n\t\t\t\t\t\t\t\t\t\t\t\tif (settingdata.authSetting['scope.writePhotosAlbum']) {\n\t\t\t\t\t\t\t\t\t\t\t\t\twx.showModal({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: '提示',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: '获取权限成功,再次点击图片即可保存',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowCancel: false,\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\twx.showModal({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: '提示',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: '获取权限失败，将无法保存到相册哦~',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowCancel: false,\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tfail(failData) {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"failData\", failData)\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tcomplete(finishData) {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"finishData\", finishData)\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete(res) {\n\t\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t//点击保存到相册\n\t\t// saveImg() {\n\t\t// \tconsole.log('保存')\n\t\t//     var that = this;\n\t\t//     wx.saveImageToPhotosAlbum({\n\t\t//       filePath: that.poster,\n\t\t//       success(res) {\n\t\t//         wx.showModal({\n\t\t//           content: '图片已保存到相册，赶紧晒一下吧~',\n\t\t//           showCancel: false,\n\t\t//           confirmText: '好的',\n\t\t//           confirmColor: '#333',\n\t\t//           success: function (res) {\n\t\t//             if (res.confirm) {\n\t\t//               console.log('用户点击确定');\n\t\t//             }\n\t\t//           }, \n\t\t// \t\t  fail: function (res) {\n\t\t// \t\t\t  console.log(res)\n\t\t//           }\n\t\t//         })\n\t\t//       },\n\t\t// \t  fail(err) {\n\t\t// \t  \tconsole.log(err)\n\t\t// \t  }\n\t\t//     })\n\t\t// },\n\t\tpreviewImg() {\n\t\t\tconsole.log('previewImg')\n\t\t\tif (this.poster) {\n\t\t\t\t//预览图片，预览后可长按保存或者分享给朋友\n\t\t\t\twx.previewImage({\n\t\t\t\t\turls: [this.poster]\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\tdrawImage(canvasAttrs) {\n\t\t\tlet that = this;\n\t\t\tlet ctx = wx.createCanvasContext('canvasPoster', this)\n\t\t\tlet canvasW = that.width // 画布的真实宽度660canvasAttrs.width\n\t\t\tlet canvasH = that.height //画布的真实高度980canvasAttrs.height\n\t\t\t// 头像和二维码大小都需要在规定大小的基础上放大像素比的比例后面都会 *this.systemInfo.pixelRatio\n\t\t\tlet headerW = 48 * this.systemInfo.pixelRatio\n\t\t\tlet headerX = (canvasW - headerW) / 2\n\t\t\tlet headerY = 40 * this.systemInfo.pixelRatio\n\t\t\tlet qrcodeW = 73 * this.systemInfo.pixelRatio\n\t\t\tlet qrcodeX = 216 * this.systemInfo.pixelRatio\n\t\t\tlet qrcodeY = 300 * this.systemInfo.pixelRatio\n\t\t\t// 填充背景\n\t\t\tctx.drawImage(this.shareInfo.bgImg, 0, 0, canvasW, canvasH)\n\t\t\tctx.save()\n\t\t\t// 绘制二维码\n\t\t\t//ctx.drawImage(this.shareInfo.qrcode, qrcodeX, qrcodeY, qrcodeW, qrcodeW)\n\t\t\tctx.drawImage(this.shareInfo.qrcode, 0, 0, qrcodeW, qrcodeW)\n\t\t\tctx.save()\n\t\t\t// 将前面绘制的各个图案一起画出来\n\t\t\tctx.draw()\n\t\t\tsetTimeout(() => {\n\t\t\t\t//下面的13以及减26推测是因为在写样式的时候写了固定的zoom: 50%而没有用像素比缩放导致的黑边，所以在生成时进行了适当的缩小生成，这个大家可以自行尝试\n\t\t\t\twx.canvasToTempFilePath({\n\t\t\t\t\tx: 13,\n\t\t\t\t\ty: 13,\n\t\t\t\t\twidth: canvasW - 26,\n\t\t\t\t\theight: canvasH - 26,\n\t\t\t\t\tdestWidth: canvasW - 26,\n\t\t\t\t\tdestHeight: canvasH - 26,\n\t\t\t\t\tcanvasId: 'canvasPoster',\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tthat.poster = res.tempFilePath\n\t\t\t\t\t\tconsole.log('that.poster', that.poster)\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}, 200)\n\t\t}\n\t}\n}\n","import mod from \"-!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-1!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./poster.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-1!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./poster.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1586957269463\n      var cssReload = require(\"D:/project/FrontEnd/HBuilderX.2.6.5.20200314.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}